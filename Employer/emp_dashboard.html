<script>
  class TaskManager {
    constructor() {
      this.taskQueue = [];
      this.isProcessing = false;
    }
  
    enqueueTask(task) {
      this.taskQueue.push(task);
      this.processTaskQueue();
    }
  
    async processTaskQueue() {
      if (this.isProcessing || this.taskQueue.length === 0) {
        return;
      }
  
      this.isProcessing = true;
  
      const task = this.taskQueue.shift();
  
      try {
        await task();
        console.log("Task executed successfully");
      } catch (error) {
        console.error("Task encountered an error:", error);
      }
  
      this.isProcessing = false;
      this.processTaskQueue();
    }
  }
  
  const taskManager = new TaskManager();
  
  taskManager.enqueueTask(async () => {
    try {
      const response = await fetchData("https://api.baserow.io/api/database/rows/table/113442/?user_field_names=true&filter__field_751992__link_row_contains=company2@test.com");
      console.log(response, "response worked!")
      return response;
    } catch (error) {
      console.log("Error occurred during task execution:", error);
      throw error;
    }
  });
  
  function fetchData(url) {
    return axios({
      method: "GET",
      url: url,
      headers: {
        Authorization: "Token " + neatlistB.key
      }
    });
  }
  
  $(document).ready(function() {
    setInterval(() => {
      taskManager.enqueueTask(async () => {
        try {
          const response = await fetchData("https://api.baserow.io/api/database/rows/table/113442/?user_field_names=true&filter__field_751992__link_row_contains=company2@test.com");
          console.log(response, "response worked!")
          return response;
        } catch (error) {
          console.log("Error occurred during task execution:", error);
          throw error;
        }
      });
    }, 5000); // Run the task every 5 seconds
  });
  </script>